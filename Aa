-- // TAMBAHAN FITUR PEMBELAJARAN (Silent Aim & Ammo) //

-- // 1. Variabel Kontrol Baru
_G.SilentAim = false
_G.InfAmmo = false

-- // 2. Logika Silent Aim (Redirecting Bullets)
-- Logika ini bekerja dengan membelokkan arah peluru (Raycast) menuju target
local mt = getrawmetatable(game)
local oldNamecall = mt.__namecall
setreadonly(mt, false)

mt.__namecall = newcclosure(function(self, ...)
    local method = getnamecallmethod()
    local args = {...}

    if _G.SilentAim and method == "FireServer" and self.Name == "ShootEvent" then -- Ganti "ShootEvent" sesuai remote game
        local target = GetTarget() -- Mengambil target dari fungsi GetTarget() yang sudah ada sebelumnya
        if target and target.Character and target.Character:FindFirstChild("Head") then
            -- Mengarahkan posisi tembakan langsung ke kepala target di sisi server
            args[1] = target.Character.Head.Position 
            return self:FireServer(unpack(args))
        end
    end
    return oldNamecall(self, ...)
end)
setreadonly(mt, true)

-- // 3. Logika Infinite Ammo (Memory Patching)
-- Teknik ini mencari nilai amunisi di dalam script senjata dan mencegahnya berkurang
RunService.Heartbeat:Connect(function()
    if _G.InfAmmo then
        -- Mencari folder alat/senjata di karakter
        for _, tool in pairs(LocalPlayer.Character:GetChildren()) do
            if tool:IsA("Tool") and tool:FindFirstChild("Ammo") then
                -- Memaksa nilai Ammo tetap di angka 999
                tool.Ammo.Value = 999
            end
        end
    end
end)

-- // 4. Tambahkan Tombol ke GUI Anda (Gunakan fungsi CreateButton sebelumnya)
CreateButton("Silent Aim: OFF", function(btn)
    _G.SilentAim = not _G.SilentAim
    btn.Text = "Silent Aim: " .. (_G.SilentAim and "ON" or "OFF")
    btn.BackgroundColor3 = _G.SilentAim and Color3.fromRGB(255, 0, 255) or Color3.fromRGB(50, 50, 50)
end)

CreateButton("Inf Ammo: OFF", function(btn)
    _G.InfAmmo = not _G.InfAmmo
    btn.Text = "Inf Ammo: " .. (_G.InfAmmo and "ON" or "OFF")
    btn.BackgroundColor3 = _G.InfAmmo and Color3.fromRGB(0, 255, 255) or Color3.fromRGB(50, 50, 50)
end)
